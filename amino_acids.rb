class AminoAcids
  attr_reader :residues
  def initialize(mass_type)
    @residues = Hash.new {|hash, key|
      raise BadSequenceError, "could not find weight for amino acid #{key.upcase}"
    }

    hsh = case mass_type
          when :monoisotopic
            monoisotopic
          when :average
            average
          else
            raise UnrecognizedMassType, "mass type #{mass_type} not recognized"
          end

    hsh.each {|k,v| @residues[k] = v }
  end

  def monoisotopic
    {
      "(3a)" => 85.05,
      "(3c)" => 117.02,
      "(3c*)" => 116.02,
      "(3d)" => 129.04,
      "(3e)" => 143.06,
      "(3f)" => 161.08,
      "(3g)" => 71.04,
      "(3h)" => 151.07,
      "(3i)" => 127.1,
      "(3k)" => 142.11,
      "(3l)" => 127.1,
      "(3m)" => 145.06,
      "(3n)" => 128.06,
      "(3p)" => 111.07,
      "(3q)" => 142.070,
      "(3r)" => 170.12,
      "(3s)" => 101.05,
      "(3t)" => 115.06,
      "(3v)" => 113.08,
      "(3w)" => 200.09,
      "(3y)" => 177.08,
      "a" => 71.03712,
      "ac-" => 43.02,
      "c" => 103.00919,
      "c*" => 102.00000,
      "d" => 115.02695,
      "e" => 129.04260,
      "f" => 147.06842,
      "g" => 57.02147,
      "h" => 137.05891,
      "i" => 113.08407,
      "k" => 128.09497,
      "l" => 113.08407,
      "m" => 131.04049,
      "n" => 114.04293,
      "p" => 97.05277,
      "q" => 128.05858,
      "r" => 156.10112,
      "s" => 87.03203,
      "t" => 101.04768,
      "u" => 85.05,
      "v" => 99.06842,
      "w" => 186.07932,
      "x" => 111.07,
      "y" => 163.06333,
      "z" => 112.06,
      # This is only used to calculate the final weight adjustment.
      "-nh2" => 0,
    }
  end

  def average
    {
      "(3a)" => 85.110,
      "(3c)" => 117.170,
      "(3c*)" => 116.160,
      "(3d)" => 129.120,
      "(3e)" => 143.140,
      "(3f)" => 161.200,
      "(3g)" => 71.080,
      "(3h)" => 151.170,
      "(3i)" => 127.190,
      "(3k)" => 142.200,
      "(3l)" => 127.190,
      "(3m)" => 145.220,
      "(3n)" => 128.130,
      "(3p)" => 111.140,
      "(3q)" => 142.16,
      "(3r)" => 170.220,
      "(3s)" => 101.110,
      "(3t)" => 115.130,
      "(3v)" => 113.160,
      "(3w)" => 200.240,
      "(3y)" => 177.200,
      "a" => 71.079,
      "ac-" => 43.05,
      "c" => 103.144,
      "c*" => 102.130,
      "d" => 115.089,
      "e" => 129.116,
      "f" => 147.177,
      "g" => 57.052,
      "h" => 137.142,
      "i" => 113.160,
      "k" => 128.174,
      "l" => 113.160,
      "m" => 131.198,
      "n" => 114.104,
      "p" => 97.117,
      "q" => 128.131,
      "r" => 156.188,
      "s" => 87.078,
      "t" => 101.105,
      "u" => 85.110,
      "v" => 99.133,
      "w" => 186.213,
      "x" => 111.140,
      "y" => 163.170,
      "z" => 112.130,
      # This is only used to calculate the final weight adjustment.
      "-nh2" => 0,
    }
  end
end
