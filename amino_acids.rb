class AminoAcids
  attr_reader :residues
  def initialize(mass_type)
    @residues = Hash.new {|hash, key|
      raise BadSequenceError, "could not find weight for amino acid #{key.upcase}"
    }

    hsh = case mass_type
          when :monoisotopic
            monoisotopic
          when :average
            average
          else
            raise UnrecognizedMassType, "mass type #{mass_type} not recognized"
          end

    hsh.each {|k,v| @residues[k] = v }
  end

  def monoisotopic
    {
      'ac-'  => 42.06,
      'a'    => 71.04,
      'c'    => 103.01,
      'd'    => 115.03,
      'e'    => 129.04,
      'f'    => 147.07,
      'g'    => 57.02,
      'h'    => 137.06,
      'i'    => 113.08,
      'k'    => 128.09,
      'l'    => 113.08,
      'm'    => 131.04,
      'n'    => 114.04,
      'p'    => 97.05,
      'q'    => 128.06,
      'r'    => 156.1,
      's'    => 87.03,
      't'    => 101.05,
      'v'    => 99.07,
      'w'    => 186.08,
      'y'    => 163.06,
      '(3a)' => 85.06,
      '(3c)' => 117.03,
      '(3d)' => 129.05,
      '(3e)' => 143.06,
      '(3f)' => 161.09,
      '(3g)' => 71.04,
      '(3h)' => 151.08,
      '(3i)' => 127.1,
      '(3k)' => 142.11,
      '(3l)' => 127.1,
      '(3m)' => 145.06,
      '(3n)' => 128.06,
      '(3p)' => 111.07,
      '(3q)' => 142.07,
      '(3r)' => 170.12,
      '(3s)' => 101.05,
      '(3t)' => 115.07,
      '(3v)' => 113.09,
      '(3w)' => 200.1,
      '(3y)' => 117.08,
      'x'    => 111.07,
      'z'    => 112.06,
      'u'    => 85.05
    }
  end

  def average
    {
      "A" => 71.079,
      "C" => 103.144,
      "D" => 115.089,
      "E" => 129.116,
      "F" => 147.177,
      "G" => 57.052,
      "H" => 137.142,
      "I" => 113.160,
      "K" => 128.174,
      "L" => 113.160,
      "M" => 131.198,
      "N" => 114.104,
      "P" => 97.117,
      "Q" => 128.131,
      "R" => 156.188,
      "S" => 87.078,
      "T" => 101.105,
      "V" => 99.133,
      "W" => 186.213,
      "Y" => 163.170,
    }
  end
end

monoisotopic = {
  "A" => 71.03712,
  "C" => 103.00919,
  "D" => 115.02695,
  "E" => 129.04260,
  "F" => 147.06842,
  "G" => 57.02147,
  "H" => 137.05891,
  "I" => 113.08407,
  "K" => 128.09497,
  "L" => 113.08407,
  "M" => 131.04049,
  "N" => 114.04293,
  "P" => 97.05277,
  "Q" => 128.05858,
  "R" => 156.10112,
  "S" => 87.03203,
  "T" => 101.04768,
  "V" => 99.06842,
  "W" => 186.07932,
  "Y" => 163.06333,
}

